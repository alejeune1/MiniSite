<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Mon panier (exercice)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Mon panier</h1>
    <p>√âtape 2 : v√©rifier les articles, puis valider un faux paiement.</p>
  </header>

  <div class="home-button-container">
    <a href="index.html" class="home-btn">üè† Retour √† l'accueil</a>
  </div>

  <main>
    <section class="intro">
      <h2>R√©capitulatif du panier</h2>
      <p>Voici les articles que vous avez ajout√©s dans la boutique d'exemple.</p>

      <div id="panier-contenu">
        <!-- Liste des articles g√©n√©r√©e en JavaScript -->
      </div>

      <p id="panier-total" style="font-size: 1.1rem; margin-top: 10px;"></p>

      <p style="margin-top: 10px;">
        <a href="achat.html">‚¨Ö Retourner √† la boutique</a>
      </p>
    </section>

    <section class="modules">
      <h2>√âtape paiement (factice)</h2>

      <p><strong>Important :</strong> ne renseignez jamais vos vrais num√©ros de carte bancaire sur ce site d'exercice.</p>

      <form onsubmit="validerAchatFaux(event)">
        <p>
          <label>Num√©ro de carte :<br>
            <input type="text"
                   name="carte"
                   placeholder="1234 5678 9012 3456"
                   maxlength="19"
                   required>
          </label>
        </p>

        <p>
          <label>Nom du titulaire :<br>
            <input type="text"
                   name="titulaire"
                   placeholder="Jean Exemple"
                   required>
          </label>
        </p>

        <p>
          <label>Date d'expiration :<br>
            <input type="month"
                   name="expiration"
                   required>
          </label>
        </p>

        <p>
          <label>Cryptogramme  :<br>
            <input type="password"
                   name="crypto"
                   maxlength="3"
                   placeholder="123"
                   required>
          </label>
        </p>

        <p>
          <button type="submit">Valider le faux achat</button>
        </p>
      </form>

      <div id="success-message" class="success-message hidden">
        <span class="check">‚úî</span>
        <p><strong>Achat simul√© avec succ√®s !</strong></p>
        <p>Aucune information r√©elle n'a √©t√© envoy√©e, et le panier a √©t√© vid√©.</p>
      </div>
    </section>
  </main>

  <footer>
    <p>Exercice p√©dagogique ‚Äì aucune donn√©e r√©elle n'est enregistr√©e.</p>
  </footer>

  <script>
    const CLE_PANIER = 'panier_exercice';

    function lirePanier() {
      try {
        const data = localStorage.getItem(CLE_PANIER);
        return data ? JSON.parse(data) : [];
      } catch (e) {
        return [];
      }
    }

    function viderPanier() {
      localStorage.removeItem(CLE_PANIER);
    }

    function afficherPanier() {
      const panier = lirePanier();
      const container = document.getElementById('panier-contenu');
      const totalElt = document.getElementById('panier-total');

      if (!panier.length) {
        container.innerHTML = "<p>Votre panier est vide. Retournez √† la boutique pour ajouter des articles.</p>";
        totalElt.textContent = "";
        return;
      }

      const liste = document.createElement('ul');
      liste.style.listStyle = 'none';
      liste.style.padding = '0';

      let total = 0;

      panier.forEach(item => {
        total += item.prix;
        const li = document.createElement('li');
        li.style.marginBottom = '6px';
        li.textContent = `${item.nom} ‚Äì ${item.prix.toFixed(2)} ‚Ç¨`;
        liste.appendChild(li);
      });

      container.innerHTML = "";
      container.appendChild(liste);

      totalElt.textContent = `Total : ${total.toFixed(2)} ‚Ç¨ (factice)`;
    }

    function validerAchatFaux(event) {
      event.preventDefault();
      viderPanier();
      afficherPanier(); // met √† jour l'affichage (panier vide)
      const box = document.getElementById('success-message');
      box.classList.remove('hidden');
      box.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    window.addEventListener('load', afficherPanier);
  </script>
</body>
</html>
